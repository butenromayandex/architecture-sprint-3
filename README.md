## Задание 1.1

Домены:

1. Домен “Телеметрия”:

- Описание: Получение данных о температуре с датчиков, установленных в домах.
- Границы контекста: Включает компоненты, отвечающие за взаимодействие с датчиками, сбор и первичную обработку данных.

2. Домен “Обработка данных”:

- Описание: Обработка и хранение данных о температуре.
- Границы контекста: Включает бизнес-логику для обработки данных и взаимодействие с базой данных PostgresSQL.

3. Домен “Мониторинг”:

- Описание: Отображение текущей температуры пользователям через веб-интерфейс.
- Границы контекста: Включает компоненты, отвечающие за генерацию и передачу актуальных данных в веб приложение, которые
  просматривает пользователь.

По диаграмме: Предполагаю, что я забыл отразить веб-приложения, которые разрабатываются на аутсорсе. И, возможно, лишние
администраторы. Но, не представляю систему без них. По этому включил их в диаграмму. Диаграмму контекста поправил.
---

## Задание 1.2

- Про диаграмму компонента Devices. Изначально, была идея использовать 4 сервиса (температура, видео, ворота, свет). Но,
  с какой-то стороны мне показалось, что это перебор и, впоследствии, я всё-таки их объединил. Сейчас думаю, что идея
  разделения на отдельные сервисы лучше. Изменил диаграмму контейнера.
- По поводу бд. Думаю, что вполне достаточно будет использовать 1 инстанс бд + 2 репликации. Плюс к этому, можно
  применить паттерн SQRS, чтение производить из реплик, запись в мастер. Исходя из задач, которые выполняют микросервисы
  я думаю это вполне реализуемо. Ещё думал применить паттерн Database per Service. Но, тут стоит подумать.

---

## Задание 1.3

- Про город принял.
- У меня так и не появилось полного понимания, что такое модуль (исходя из описания). Я додумал сам, и у меня модуль -
  это устройство, которое может управлять другими устройствами в доме. Возможно, как Яндекс Модуль, или что-то в этом
  роде. На диаграмме я это отразил. Дом, может иметь как устройства (device) так и модули. Модули в свою очередь могут
  быть связаны с несколькими устройствами и управляться пользователями не через веб-интерфейс. Но, я не показал
  связующую таблицу
  module_device, в которой будут храниться как раз эти связи. Управление модулем по расписанию думаю что не нужно.

---

## Что реализовано

- Реализовано только первое задание
- Документация API в файле ./api.yaml
- Диаграммы C4 находятся в папке ./diagrams
- ERD тут - ./diagrams/ERD.puml

---

## Задание 2

Оля Майстренко написала на каникулах, что второе задание полностью, в принципе, опционально. Я его не делал, и, если возможно, не
планирую сдавать. Если критично - то постараюсь успеть и его.

---

# Базовая настройка

## Запуск minikube

[Инструкция по установке](https://minikube.sigs.k8s.io/docs/start/)

```bash
minikube start
```

## Добавление токена авторизации GitHub

[Получение токена](https://github.com/settings/tokens/new)

```bash
kubectl create secret docker-registry ghcr --docker-server=https://ghcr.io --docker-username=<github_username> --docker-password=<github_token> -n default
```

## Установка API GW kusk

[Install Kusk CLI](https://docs.kusk.io/getting-started/install-kusk-cli)

```bash
kusk cluster install
```

## Настройка terraform

[Установите Terraform](https://yandex.cloud/ru/docs/tutorials/infrastructure-management/terraform-quickstart#install-terraform)

Создайте файл ~/.terraformrc

```hcl
provider_installation {
  network_mirror {
    url = "https://terraform-mirror.yandexcloud.net/"
    include = ["registry.terraform.io/*/*"]
  }
  direct {
    exclude = ["registry.terraform.io/*/*"]
  }
}
```

## Применяем terraform конфигурацию

```bash
cd terraform
terraform apply
```

## Настройка API GW

```bash
kusk deploy -i api.yaml
```

## Проверяем работоспособность

```bash
kubectl port-forward svc/kusk-gateway-envoy-fleet -n kusk-system 8080:80
curl localhost:8080/hello
```

## Delete minikube

```bash
minikube delete
```
